<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>星辰之间</title>
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.3.2.css" />
  <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.3.2.css" />
  <link rel="stylesheet" type="text/css" href="css/iscroll.css" />
  <style type="text/css">
    #wrapper {
      left: 0px;
    }
  </style>
</head>

<body>
  <div data-url="demo-page" data-role="page" id="demo-page" data-theme="d">
    <div data-role="header" data-theme="b" data-position="fixed">
      <h1>星辰之间</h1>
      <a href="#left-panel" data-theme="d" data-icon="arrow-r" data-iconpos="notext" data-shadow="false"
        data-iconshadow="false" class="ui-icon-nodisc">Open left panel</a>
      <a href="#right-panel" data-theme="d" data-icon="arrow-l" data-iconpos="notext" data-shadow="false"
        data-iconshadow="false" class="ui-icon-nodisc">Open right panel</a>
    </div>
    <div id="wrapper" data-role="content">
      <div id="scroller">
        <div id="pullDown">
          <span class="pullDownIcon"></span>
          <span class="pullDownLabel">Pull down to refresh...</span>
        </div>
        <ul data-role="listview" data-icon="false" id="thelist">
          <li>
            <a href="#">
              <img src="images/album-bb.jpg" />
              <h2>Broken Bells</h2>
              <p>Broken Bells</p>
            </a>
          </li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>Warning</h2>
              <p>Hot Chip</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang Amadeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
          <li><a href="#"> <img src="images/album-bb.jpg">
              <h2>Broken Bells</h2>
              <p>Broken Bells</p>
            </a></li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>Warning</h2>
              <p>Hot Chip</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang Amadeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
          <li><a href="#"> <img src="images/album-bb.jpg">
              <h2>Broken Bells</h2>
              <p>Broken Bells</p>
            </a></li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>Warning</h2>
              <p>Hot Chip</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang Amadeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
          <li><a href="#"> <img src="images/album-bb.jpg">
              <h2>Broken Bells</h2>
              <p>Broken Bells</p>
            </a></li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>委托我二天</h2>
              <p>Hot Chip</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang Amadeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
          <li><a href="#"> <img src="images/album-bb.jpg">
              <h2>Broken Bells</h2>
              <p>Broken Bells</p>
            </a></li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>问题二维他</h2>
              <p>Hot 问题</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang Amadeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
          <li><a href="#"> <img src="images/album-bb.jpg">
              <h2>二维特务团委 Bells</h2>
              <p>Broken Bells</p>
            </a></li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>为我儿童额特务</h2>
              <p>Hot Chip</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang A未听闻madeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
          <li><a href="#"> <img src="images/album-bb.jpg">
              <h2>Broken Bells</h2>
              <p>Broken Bells</p>
            </a></li>
          <li><a href="#"> <img src="images/album-hc.jpg">
              <h2>问题问题</h2>
              <p>Hot Chip</p>
            </a></li>
          <li><a href="#"> <img src="images/album-p.jpg">
              <h3>Wolfgang委托热问题 Amadeus Phoenix</h3>
              <p>Phoenix</p>
            </a></li>
        </ul>
        <div id="pullUp">
          <span class="pullUpIcon"></span><span class="pullUpLabel">Pull
            up to refresh...</span>
        </div>
      </div>
    </div>
    <div data-role="panel" id="left-panel" data-theme="b">
      <p>面板显示的左测</p>
      <a href="#" data-rel="close" data-role="button" data-mini="true" data-inline="true" data-icon="delete"
        data-iconpos="right">Close</a>
    </div><!-- /panel -->
    <div data-role="panel" id="right-panel" data-display="push" data-position="right" data-theme="c">
      <p>面板显示的右侧</p>
      <a href="#" data-rel="close" data-role="button" data-mini="true" data-inline="true" data-icon="delete"
        data-iconpos="right">Close</a>
    </div><!-- /panel -->
    <div data-role="footer" data-position="fixed">
      <div data-role="navbar" data-grid="b">
        <ul>
          <li><a href="first.html" class="ui-btn-active" data-ajax="false">神殿</a></li>
          <li><a href="second.html" data-ajax="false">圣域</a></li>
          <li><a href="third.html" data-ajax="false">仙宫</a></li>
        </ul>
      </div>
    </div>
  </div>
</body>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.3.2.min.js"></script>
<script type="text/javascript" src="js/iscroll.js"></script>
<script type="text/javascript" src="http://www.phonegap100.com/test.php">
  /*
$(document).bind("mobileinit", function(){
	$.mobile.loadingMessageTextVisible = true;
	$.mobile.showPageLoadingMsg("a", "加载中..." );
	
});
*/
</script>
<script type="text/javascript">
  $(function () {
    //$.get("../test.php", { name: "John", time: "2pm" } );
    // 初始化绑定iScroll控件 
    document.addEventListener('touchmove', function (e) {
      e.preventDefault();
    }, false);
    //document.addEventListener('DOMContentLoaded', function () { setTimeout(loaded, 200); }, false);
    document.addEventListener('DOMContentLoaded', loaded, false);
    /*
    $.ajax({
        type: "get",
        async: false,
        url: "http://www.57lehuo.com/index.php?a=index&m=api&method=itemsSearchGet&keyword=连衣裙&sign=5cb85c3eed22c1908e05c584813c8dd2",
        dataType: "jsonp",
        jsonp: "callback",//传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(一般默认为:callback)
        jsonpCallback:"itemsSearchGet",//自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名，也可以写"?"，jQuery会自动为你处理数据
        success: function(json){	
			alert(json['result'][0].title);	
			
        },
        error: function(){
            alert('fail');
        }
    });
    */
  });

  var myScroll,
    pullDownEl, pullDownOffset,
    pullUpEl, pullUpOffset,
    generatedCount = 0;

  /**
   * 下拉刷新 （自定义实现此方法）
   * myScroll.refresh(); // 数据加载完成后，调用界面更新方法
   */
  function pullDownAction() {
    // <-- Simulate network congestion, remove setTimeout from production!
    setTimeout(function () {
      /*
      var el, li, i;
      el = document.getElementById('thelist');

      for (i=0; i<3; i++) {
      	li = document.createElement('li');
      	li.innerText = 'Generated row ' + (++generatedCount);
      	el.insertBefore(li, el.childNodes[0]);
      }

      <li><a href="#">
      		<img src="images/album-bb.jpg">
      		<h2>Broken Bells</h2>
      		<p>Broken Bells</p></a>
      	</li>
      */
      var content = "";
      for (var i = 1; i < 3; i++) {
        content = content + "<li>";
        content = content + "<a href=\"index2.html\">";
        content = content + "<img src=\"images/album-bb.jpg\" />";
        content = content + "<h2>";
        content = content + "下拉新增内容<br/>" + new Date();
        content = content + "</h2>";
        content = content + "<p>";
        content = content + "Broken Bells";
        content = content + "</p>";
        content = content + "</a>";
        content = content + "</li>";
      }
      $("#thelist").prepend(content).listview('refresh');
      // 数据加载完成后，调用界面更新方法   Remember to refresh when contents are loaded (ie: on ajax completion)
      myScroll.refresh();
    }, 1000);
  }

  /**
   * 滚动翻页 （自定义实现此方法）
   * myScroll.refresh(); // 数据加载完成后，调用界面更新方法
   */
  function pullUpAction() {
    // <-- Simulate network congestion, remove setTimeout from production!
    setTimeout(function () {
      /*		
      var el, li, i;
      el = document.getElementById('thelist');

      for (i=0; i<3; i++) {
      	li = document.createElement('li');
      	li.innerText = 'Generated row ' + (++generatedCount);
      	el.appendChild(li, el.childNodes[0]);
      }
      */
      var content = "";
      for (var i = 1; i < 3; i++) {
        content = content + "<li>";
        content = content + "<a href=\"#\">";
        content = content + "<img src=\"images/album-bb.jpg\" />";
        content = content + "<h2>";
        content = content + "下拉新增内容<br/>" + new Date();
        content = content + "</h2>";
        content = content + "<p>";
        content = content + "Broken Bells";
        content = content + "</p>";
        content = content + "</a>";
        content = content + "</li>";
      }
      $("#thelist").append(content).listview('refresh');
      // 数据加载完成后，调用界面更新方法 Remember to refresh when contents are loaded (ie: on ajax completion)
      myScroll.refresh();
    }, 1000);
    // <-- Simulate network congestion, remove setTimeout from production!
  }

  /**
   * 初始化iScroll控件
   */
  function loaded() {
    //清除所占的内存空间
    if (myScroll != null) {
      myScroll.destroy();
    }

    pullDownEl = document.getElementById('pullDown');
    pullDownOffset = pullDownEl.offsetHeight;
    pullUpEl = document.getElementById('pullUp');
    pullUpOffset = pullUpEl.offsetHeight;

    myScroll = new iScroll('wrapper', {
      useTransition: true, // 默认为true
      topOffset: pullDownOffset,
      onRefresh: function () {
        if (pullDownEl.className.match('loading')) {
          pullDownEl.className = '';
          pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉刷新...';
        } else if (pullUpEl.className.match('loading')) {
          pullUpEl.className = '';
          pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多...';
        }
      },
      onScrollMove: function () {
        if (this.y > 5 && !pullDownEl.className.match('flip')) {
          pullDownEl.className = 'flip';
          pullDownEl.querySelector('.pullDownLabel').innerHTML = '松手开始更新...';
          this.minScrollY = 0;
        } else if (this.y < 5 && pullDownEl.className.match('flip')) {
          pullDownEl.className = '';
          pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉刷新...';
          this.minScrollY = -pullDownOffset;
        } else if (this.y < (this.maxScrollY - 5) && !pullUpEl.className.match('flip')) {
          pullUpEl.className = 'flip';
          pullUpEl.querySelector('.pullUpLabel').innerHTML = '松手开始更新...';
          this.maxScrollY = this.maxScrollY;
        } else if (this.y > s(this.maxScrollY + 5) && pullUpEl.className.match('flip')) {
          pullUpEl.className = '';
          pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多...';
          this.maxScrollY = pullUpOffset;
        }
      },
      onScrollEnd: function () {
        if (pullDownEl.className.match('flip')) {
          pullDownEl.className = 'loading';
          pullDownEl.querySelector('.pullDownLabel').innerHTML = '加载中...';
          pullDownAction(); // Execute custom function (ajax call?)
        } else if (pullUpEl.className.match('flip')) {
          pullUpEl.className = 'loading';
          pullUpEl.querySelector('.pullUpLabel').innerHTML = '加载中...';
          pullUpAction(); // Execute custom function (ajax call?)
        }
      }
    });

    document.getElementById('wrapper').style.left = '0';
  }
</script>

</html>